<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-image: url("doodle2.png");
            /* 2.png 5.jpeg 14.jpg  */


        }

        main {
            width: 90%;
            /* 70%*/
            height: 600px;
            margin: 110 auto;
            display: flex;
        }

        #grid {
            display: grid;
            width: 600px;
            height: 600px;
            margin: auto auto;
            grid-template-columns: repeat(auto-fill, 75px);
            /* width / n of columns */
            grid-template-rows: repeat(auto-fill, 75px);
            /* height / n of rows */
            background-color: rgb(238, 238, 238);
            box-shadow: 0 0 100px rgb(40, 40, 41);
            border: solid rgb(40, 40, 41) 5px;
            border-radius: 5px;
        }

        .cell {
            border: solid rgb(40, 40, 41) 1px;
        }

        #left-side {
            position: absolute;
            /* removed */
            margin: 20px 0px 20px 20px;
            background-color: rgb(40, 40, 41);
            border-radius: 2em;
            box-shadow: 0 0 10px rgb(40, 40, 41);
        }

        #left-side div {
            margin: 70px 20px 70px 20px;

        }

        ul {
            display: flex;
            list-style: none;
        }

        li {
            margin-right: 10px;
        }

        button {
            opacity: 0.5;
            border-radius: 2em;
            background-color: rgb(196, 196, 196);
            border: solid 0;
            width: 4em;
            height: 2em;
            cursor: pointer;

        }

        button:hover {
            opacity: 1;
            scale: 1.1;
        }

        .color {
            width: 2em;
            border: white solid 1px;
        }

        .active {
            opacity: 1;
        }

        #black {
            background-color: black;
        }

        #white {
            background-color: white;
        }

        #rainbow {
            background-color: gray;
        }

        .rainbow{
            transition: all 0.3s linear;
        }
    </style>
</head>

<body>
    <main>
        <div id="left-side">
            <div id="colors">
                <ul>
                    <li><button id="black" class="color active" value="black"></button></li>
                    <li><button id="white" class="color" value="white"></button></li>
                    <li><button id="rainbow" class="color" value="rainbow"></button></li>
                </ul>
            </div>

            <div id="sizes">
                <ul>
                    <li> <button value="8">8x8</button></li>
                    <li> <button class="active" value="16">16x16</button></li>
                    <li> <button value="32">32x32</button></li>
                    <li> <button value="64">64x64</button></li>
                </ul>
            </div>

            <div><button class="active" style="width:7em;" value="mode">Mode: drag</button></div>

            <div><button class="active" value="reset">Reset</button></div>

            <div><button class="active" value="save">Save</button></div>


        </div>



        <div id="grid">

        </div>


        <div id="right-side">

        </div>
    </main>

    <script>

        let grid = document.querySelector("#grid");
        let size = 16;
        let color = "black";

        createGrid();



        function createGrid() {

            emptyGrid();
            
            let width = grid.clientWidth; //gets grid's width excluding border 

            // calculate new cell size based on number of cells

            grid.setAttribute("style", `grid-template-columns:repeat(auto-fill,${width / size}px); grid-template-rows:repeat(auto-fill,${width / size}px);`);

            for (let i = 0; i < size * size; i++) {
                const div = document.createElement("div");
                div.classList.add("cell");
                div.value = ""
                div.addEventListener("mouseover", (e) => {
                    e.target.classList.remove("rainbow");
                    if (color == "white") {
                        e.target.setAttribute("style", `background-color:rgb(238, 238, 238);`);
                    } else if (color == "black") {

                        //this code words by giving a value of "visited" to each cell that has been touched by the cursor
                        //then it extracts the background color of a cell and decreases it each time the cell is stepped on

                        let intensity;

                        intensity = window.getComputedStyle(e.target).getPropertyValue("background-color");

                        //this line gets the R value of the RGB color, since for shades of black R, G and B values are the same
                        intensity = intensity.replace(/[^\d,]/g, "").split(",")[0];

                        if (e.target.value != "visited"){
                            e.target.value = "visited";
                            intensity =  210;
                        } else if (intensity > 0) {
                            intensity-=30;
                        } else {
                            intensity = 0;
                        }
  
                        e.target.setAttribute("style", `background-color:rgb(${intensity}, ${intensity}, ${intensity});`);

                    } else {
                        e.target.classList.add("rainbow");
                        e.target.setAttribute("style", `background-color:rgb(${getRandomInt(50, 255)}, ${getRandomInt(50, 255)}, ${getRandomInt(50, 255)});`);
                    }
                });
                grid.appendChild(div);
            }

        }

        function emptyGrid() {
            while (grid.firstChild) {
                grid.removeChild(grid.firstChild);
            }
        }


        let buttonDivs = ["colors", "sizes"];

        buttonDivs.forEach(function (divName) {
            let sizesDiv = document.querySelector(`#${divName}`);
            let sizeButtons = sizesDiv.querySelectorAll("button");
            sizeButtons.forEach(function (button) {
                button.addEventListener("click", function (e) {
                    sizeButtons.forEach(function (button) {
                        button.classList.remove("active");
                    });
                    e.target.classList.add("active");
                    if (divName == "colors") {
                        color = e.target.value;
                    } else {
                        size = e.target.value;
                        createGrid();
                    }
                });
            });
        });

        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive
        }

        // setting events for remaining buttons



    </script>
</body>

</html>